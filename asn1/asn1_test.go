package main

import (
	"encoding/hex"
	"fmt"
	"testing"
)

const (
	signature = "308203d506092a864886f70d010702a08203c6308203c2020101310d300b0609608648016503040201303e06092a864886f70d010701a031042f546869732069732074686520636f6e74656e7420746f206265207369676e656420776974682043416445532d424553a08201b3308201af30820154a003020102020101300a06082a8648ce3d0403023045310b3009060355040613025349311a3018060355040a131154657374204f7267616e697a6174696f6e311a30180603550403131143416445532054657374205369676e6572301e170d3235313232313230303034345a170d3236313232313231303034345a3045310b3009060355040613025349311a3018060355040a131154657374204f7267616e697a6174696f6e311a30180603550403131143416445532054657374205369676e65723059301306072a8648ce3d020106082a8648ce3d0301070342000444c23e625b3f8e2d04c14edec49a6e8c110c642e1f74ac1a2cad9b813eb440f5f3ed802c80bd8d28c9ed06c55667c551c2c919a4d50aff93f21ac696dd583979a3353033300e0603551d0f0101ff04040302078030130603551d25040c300a06082b06010505070303300c0603551d130101ff04023000300a06082a8648ce3d040302034900304602210087f860bb9edee4ee0cfe6adfd9ae65253c4e51b2938eae0891fe48077f971418022100c58384214865099df9503ab0dbd19241c9baf3149283e2ca740eb5496a46430e318201b5308201b1020101304a3045310b3009060355040613025349311a3018060355040a131154657374204f7267616e697a6174696f6e311a30180603550403131143416445532054657374205369676e6572020101300b0609608648016503040201a081fd301806092a864886f70d010903310b06092a864886f70d010701302f06092a864886f70d0109043122042055017ba96e264e591dfc5c6d81f958173e14d785ccbb39c9b92dc1910cc06b93301c06092a864886f70d010905310f170d3235313232313231303034345a308191060b2a864886f70d010910022f318181307f307d307b300b06096086480165030402010420bf4faaea2331cf6f3798ef7bdfe75b4bf3edc0ecffc23aa03db160c57d7ee251304a3045310b3009060355040613025349311a3018060355040a131154657374204f7267616e697a6174696f6e311a30180603550403131143416445532054657374205369676e6572020101300a06082a8648ce3d04030204473045022100e8342a4d295fa5c5d97d73b47c617d1713e0ee31388c5089bcaabd63b31c8cb002200d3e73aad03bf9776cff1a1855071a98c6b51405c5d7effc79df0cc9ce57b58c"
)

func Test_parseASN1Value(t *testing.T) {

	derBytes, err := hex.DecodeString(signature)
	if err != nil {
		t.Fatalf("failed to decode the .p7m signature: %v", err)
	}

	// Print ASN.1
	err = PrintASN1(derBytes, " ")
	if err != nil {
		fmt.Printf("Error parsing ASN.1: %v\n", err)
		return
	}

}
